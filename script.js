const data = {
  "title": "Ciclo Virtuoso de Prospec√ß√£o e Relacionamento",
  "cycles": [
    {
      "name": "Hunting",
      "period": "1¬™ Quinzena",
      "color": "#3498db",
      "weeks": [
        {
          "name": "Semana 1",
          "activities": [
            {
              "day": "Segunda",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Planejamento quinzenal de prospec√ß√£o",
                  "result": "Lista de leads priorit√°rios",
                  "nextAction": "Pesquisa aprofundada sobre leads",
                  "icon": "üìã"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Pesquisa sobre leads indicados",
                  "result": "Perfis detalhados de leads",
                  "nextAction": "Prepara√ß√£o de abordagem personalizada",
                  "icon": "üîç"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo com cliente potencial indicador",
                  "result": "Novas indica√ß√µes",
                  "nextAction": "Agendamento de contatos com novas indica√ß√µes",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Contato com leads indicados",
                  "result": "Agendamento de reuni√µes",
                  "nextAction": "Prepara√ß√£o para reuni√µes agendadas",
                  "icon": "üìû"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Follow-up e agendamento de reuni√µes",
                  "result": "Calend√°rio de reuni√µes atualizado",
                  "nextAction": "Prepara√ß√£o de material para reuni√µes",
                  "icon": "üìÖ"
                }
              ]
            },
            {
              "day": "Ter√ßa",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Revis√£o de estrat√©gias de indica√ß√£o",
                  "result": "Ajustes no programa de indica√ß√µes",
                  "nextAction": "Comunica√ß√£o de mudan√ßas aos clientes",
                  "icon": "üîÑ"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Reuni√µes com clientes para pedir indica√ß√µes",
                  "result": "Lista de novas indica√ß√µes",
                  "nextAction": "Pesquisa inicial sobre novas indica√ß√µes",
                  "icon": "ü§ù"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Networking em evento do setor",
                  "result": "Novos contatos estabelecidos",
                  "nextAction": "Follow-up com novos contatos",
                  "icon": "üåê"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Elabora√ß√£o de propostas para leads",
                  "result": "Propostas personalizadas",
                  "nextAction": "Agendamento de apresenta√ß√µes",
                  "icon": "üìù"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Atualiza√ß√£o de CRM e planejamento",
                  "result": "CRM atualizado e plano de a√ß√£o",
                  "nextAction": "Prioriza√ß√£o de tarefas para o dia seguinte",
                  "icon": "üíª"
                }
              ]
            },
            {
              "day": "Quarta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "An√°lise de feedback de indica√ß√µes",
                  "result": "Insights para melhorar abordagem",
                  "nextAction": "Ajuste nas estrat√©gias de abordagem",
                  "icon": "üìä"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Reuni√µes com novos leads indicados",
                  "result": "Oportunidades identificadas",
                  "nextAction": "Elabora√ß√£o de propostas personalizadas",
                  "icon": "ü§ù"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo / Networking estrat√©gico",
                  "result": "Novas parcerias potenciais",
                  "nextAction": "Planejamento de a√ß√µes conjuntas",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Follow-up de reuni√µes e propostas",
                  "result": "Pr√≥ximos passos definidos",
                  "nextAction": "Agendamento de novas intera√ß√µes",
                  "icon": "üìû"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Desenvolvimento de parcerias estrat√©gicas",
                  "result": "Novas fontes de indica√ß√µes",
                  "nextAction": "Integra√ß√£o de parceiros ao processo",
                  "icon": "ü§ù"
                }
              ]
            },
            {
              "day": "Quinta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Prepara√ß√£o de material personalizado",
                  "result": "Conte√∫do de alto valor",
                  "nextAction": "Distribui√ß√£o de conte√∫do aos leads",
                  "icon": "üìÑ"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Reuni√µes com leads de alto potencial",
                  "result": "Avan√ßo nas negocia√ß√µes",
                  "nextAction": "Elabora√ß√£o de propostas finais",
                  "icon": "ü§ù"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo com parceiro estrat√©gico",
                  "result": "Plano de a√ß√£o conjunto",
                  "nextAction": "Implementa√ß√£o de a√ß√µes acordadas",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Prospec√ß√£o ativa (calls, emails)",
                  "result": "Novos leads qualificados",
                  "nextAction": "Agendamento de reuni√µes iniciais",
                  "icon": "üìû"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "An√°lise de resultados e ajustes",
                  "result": "KPIs atualizados",
                  "nextAction": "Defini√ß√£o de metas para pr√≥xima semana",
                  "icon": "üìä"
                }
              ]
            },
            {
              "day": "Sexta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Revis√£o semanal de prospec√ß√£o",
                  "result": "Avalia√ß√£o de performance",
                  "nextAction": "Identifica√ß√£o de √°reas de melhoria",
                  "icon": "üìà"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Contato com clientes para novas indica√ß√µes",
                  "result": "Renova√ß√£o do pipeline",
                  "nextAction": "Categoriza√ß√£o e prioriza√ß√£o de leads",
                  "icon": "üìû"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo / Estudo de mercado",
                  "result": "Novos insights de mercado",
                  "nextAction": "Aplica√ß√£o de insights nas estrat√©gias",
                  "icon": "üìö"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Planejamento de a√ß√µes para semana seguinte",
                  "result": "Plano semanal estruturado",
                  "nextAction": "Prepara√ß√£o de recursos necess√°rios",
                  "icon": "üìÖ"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Atualiza√ß√£o de CRM e relat√≥rios",
                  "result": "Relat√≥rios de performance",
                  "nextAction": "Compartilhamento de resultados com lideran√ßa",
                  "icon": "üíª"
                }
              ]
            }
          ]
        },
        {
          "name": "Semana 2",
          "activities": [
            // Repetir estrutura da Semana 1, ajustando a√ß√µes conforme necess√°rio
          ]
        }
      ]
    },
    {
      "name": "Farming",
      "period": "2¬™ Quinzena",
      "color": "#2ecc71",
      "weeks": [
        {
          "name": "Semana 3",
          "activities": [
            {
              "day": "Segunda",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Planejamento quinzenal de relacionamento",
                  "result": "Lista de clientes priorit√°rios",
                  "nextAction": "Prepara√ß√£o de an√°lises personalizadas",
                  "icon": "üìã"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Revis√£o de carteiras de clientes",
                  "result": "Oportunidades de otimiza√ß√£o",
                  "nextAction": "Agendamento de reuni√µes de revis√£o",
                  "icon": "üìä"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo com cliente VIP",
                  "result": "Fortalecimento do relacionamento",
                  "nextAction": "Follow-up com a√ß√µes discutidas",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Reuni√µes de revis√£o de carteira",
                  "result": "Ajustes nas estrat√©gias de investimento",
                  "nextAction": "Implementa√ß√£o de mudan√ßas acordadas",
                  "icon": "ü§ù"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "An√°lise de oportunidades de cross-selling",
                  "result": "Lista de produtos potenciais por cliente",
                  "nextAction": "Prepara√ß√£o de apresenta√ß√µes personalizadas",
                  "icon": "üìà"
                }
              ]
            },
            {
              "day": "Ter√ßa",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Prepara√ß√£o de relat√≥rios personalizados",
                  "result": "Relat√≥rios de desempenho por cliente",
                  "nextAction": "Envio de relat√≥rios e agendamento de calls",
                  "icon": "üìÑ"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Calls de acompanhamento com clientes",
                  "result": "Feedback e novas demandas",
                  "nextAction": "Elabora√ß√£o de propostas de ajuste",
                  "icon": "üìû"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Envio de material informativo/educacional",
                  "result": "Engajamento e valor agregado",
                  "nextAction": "Follow-up com participantes",
                  "icon": "üìö"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Reuni√µes de apresenta√ß√£o de novos produtos",
                  "result": "Aumento de share of wallet",
                  "nextAction": "Processamento de novas aplica√ß√µes",
                  "icon": "üíº"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Atualiza√ß√£o de CRM e planejamento",
                  "result": "CRM atualizado e plano de a√ß√£o",
                  "nextAction": "Prioriza√ß√£o de tarefas para o dia seguinte",
                  "icon": "üíª"
                }
              ]
            },
            {
              "day": "Quarta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "An√°lise de satisfa√ß√£o dos clientes",
                  "result": "Insights para melhorias",
                  "nextAction": "Desenvolvimento de a√ß√µes corretivas",
                  "icon": "üòä"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Visitas presenciais a clientes-chave",
                  "result": "Fortalecimento de relacionamentos",
                  "nextAction": "Elabora√ß√£o de propostas personalizadas",
                  "icon": "üöó"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo / Networking interno",
                  "result": "Alinhamento com outras √°reas",
                  "nextAction": "Planejamento de a√ß√µes interdepartamentais",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Implementa√ß√£o de melhorias de servi√ßo",
                  "result": "Aumento na satisfa√ß√£o do cliente",
                  "nextAction": "Comunica√ß√£o das melhorias aos clientes",
                  "icon": "üîß"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Convite para eventos agendados",
                  "result": "Calend√°rio de eventos",
                  "nextAction": "In√≠cio da organiza√ß√£o do pr√≥ximo evento",
                  "icon": "üìÖ"
                }
              ]
            },
            {
              "day": "Quinta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Revis√£o de metas de reten√ß√£o",
                  "result": "Estrat√©gias de fideliza√ß√£o atualizadas",
                  "nextAction": "Implementa√ß√£o de novas t√°ticas",
                  "icon": "üéØ"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Reuni√µes de planejamento sucess√≥rio",
                  "result": "Planos sucess√≥rios estruturados",
                  "nextAction": "Agendamento de reuni√µes familiares",
                  "icon": "üë™"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo com parceiro estrat√©gico",
                  "result": "Novas oportunidades de colabora√ß√£o",
                  "nextAction": "Desenvolvimento de ofertas conjuntas",
                  "icon": "üçΩÔ∏è"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Sess√µes de consultoria financeira",
                  "result": "Planos financeiros atualizados",
                  "nextAction": "Acompanhamento das a√ß√µes recomendadas",
                  "icon": "üí∞"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "An√°lise de resultados e ajustes",
                  "result": "KPIs de relacionamento atualizados",
                  "nextAction": "Defini√ß√£o de metas para pr√≥xima semana",
                  "icon": "üìä"
                }
              ]
            },
            {
              "day": "Sexta",
              "tasks": [
                {
                  "time": "08:00 - 09:00",
                  "action": "Revis√£o semanal de farming",
                  "result": "Avalia√ß√£o de performance",
                  "nextAction": "Identifica√ß√£o de √°reas de melhoria",
                  "icon": "üìà"
                },
                {
                  "time": "09:00 - 12:00",
                  "action": "Calls de feedback com clientes",
                  "result": "Insights para aprimoramento",
                  "nextAction": "Implementa√ß√£o de sugest√µes vi√°veis",
                  "icon": "üìû"
                },
                {
                  "time": "12:00 - 13:00",
                  "action": "Almo√ßo / Estudo de novos produtos",
                  "result": "Conhecimento atualizado",
                  "nextAction": "Planejamento de apresenta√ß√µes aos clientes",
                  "icon": "üìö"
                },
                {
                  "time": "13:00 - 16:00",
                  "action": "Planejamento de a√ß√µes para semana seguinte",
                  "result": "Plano semanal estruturado",
                  "nextAction": "Prepara√ß√£o de recursos necess√°rios",
                  "icon": "üìÖ"
                },
                {
                  "time": "16:00 - 18:00",
                  "action": "Atualiza√ß√£o de CRM e relat√≥rios",
                  "result": "Relat√≥rios de performance",
                  "nextAction": "Compartilhamento de resultados com stakeholders",
                  "icon": "üíª"
                }
              ]
            }
          ]
        },
        {
          "name": "Semana 4",
          "activities": [
            // Repetir estrutura da Semana 3, ajustando a√ß√µes conforme necess√°rio
          ]
        }
      ]
    }
  ],
  "metrics": [
    {
      "name": "Novas indica√ß√µes obtidas",
      "value": 0,
      "icon": "üìä"
    },
    {
      "name": "Reuni√µes de prospec√ß√£o realizadas",
      "value": 0,
      "icon": "ü§ù"
    },
    {
      "name": "Novos clientes conquistados",
      "value": 0,
      "icon": "üéâ"
    },
    {
      "name": "Aumento de AUM",
      "value": 0,
      "icon": "üí∞"
    },
    {
      "name": "Taxa de reten√ß√£o de clientes",
      "value": 0,
      "icon": "üîí"
    },
    {
      "name": "Satisfa√ß√£o m√©dia dos clientes",
      "value": 0,
      "icon": "üòä"
    },
    {
      "name": "Produtos cross-selling vendidos",
      "value": 0,
      "icon": "üõçÔ∏è"
    }
  ],
  "reflection": {
    "questions": [
      "Quais foram os maiores sucessos em hunting este m√™s?",
      "Quais estrat√©gias de farming foram mais efetivas?",
      "Que ajustes precisam ser feitos para o pr√≥ximo m√™s?",
      "Qual foi o aprendizado mais valioso?"
    ]
  },
  "nextMonthPlanning": {
    "huntingPriorities": [
      {"id": 1, "description": ""},
      {"id": 2, "description": ""},
      {"id": 3, "description": ""}
    ],
    "farmingPriorities": [
      {"id": 1, "description": ""},
      {"id": 2, "description": ""},
      {"id": 3, "description": ""}
    ],
    "opportunities": "",
    "personalDevelopment": ""
  }
};

function renderApp() {
    const app = document.getElementById('app');
    app.innerHTML = `
        <h1>${data.title}</h1>
        ${renderCycles()}
        ${renderMetrics()}
        ${renderReflection()}
        ${renderPlanning()}
    `;
}

function renderCycles() {
    return data.cycles.map(cycle => `
        <div class="cycle" style="border-color: ${cycle.color};">
            <h2>${cycle.name} - ${cycle.period}</h2>
            ${renderWeeks(cycle.weeks)}
        </div>
    `).join('');
}

function renderWeeks(weeks) {
    return weeks.map(week => `
        <div class="week">
            <h3>${week.name}</h3>
            ${renderActivities(week.activities)}
        </div>
    `).join('');
}

function renderActivities(activities) {
    return activities.map(activity => `
        <div class="day">
            <h4>${activity.day}</h4>
            ${renderTasks(activity.tasks)}
        </div>
    `).join('');
}

function renderTasks(tasks) {
    return tasks.map(task => `
        <div class="task">
            <p><strong>${task.time}</strong> ${task.icon} ${task.action}</p>
            <p>Resultado: ${task.result}</p>
            <p>Pr√≥xima a√ß√£o: ${task.nextAction}</p>
        </div>
    `).join('');
}

function renderMetrics() {
    return `
        <div class="metrics">
            <h2>M√©tricas Mensais</h2>
            ${data.metrics.map(metric => `
                <p>${metric.icon} ${metric.name}: ${metric.value}</p>
            `).join('')}
        </div>
    `;
}

function renderReflection() {
    return `
        <div class="reflection">
            <h2>Reflex√£o Mensal</h2>
            <ul>
                ${data.reflection.questions.map(question => `
                    <li>${question}</li>
                `).join('')}
            </ul>
        </div>
    `;
}

function renderPlanning() {
    return `
        <div class="planning">
            <h2>Planejamento para o Pr√≥ximo M√™s</h2>
            <h3>Prioridades de Hunting</h3>
            <ol>
                ${data.nextMonthPlanning.huntingPriorities.map(priority => `
                    <li>${priority.description}</li>
                `).join('')}
            </ol>
            <h3>Prioridades de Farming</h3>
            <ol>
                ${data.nextMonthPlanning.farmingPriorities.map(priority => `
                    <li>${priority.description}</li>
                `).join('')}
            </ol>
            <h3>Oportunidades</h3>
            <p>${data.nextMonthPlanning.opportunities}</p>
            <h3>Desenvolvimento Pessoal/Profissional</h3>
            <p>${data.nextMonthPlanning.personalDevelopment}</p>
        </div>
    `;
}

// Inicializa√ß√£o do Miro SDK
miro.onReady(() => {
    miro.initialize({
        extensionPoints: {
            bottomBar: {
                title: 'Ciclo Virtuoso',
                svgIcon: '<circle cx="12" cy="12" r="9" fill="none" fill-rule="evenodd" stroke="currentColor" stroke-width="2"/>',
                onClick: async () => {
                    const authorized = await miro.isAuthorized();
                    if (authorized) {
                        createProprietaryBoard();
                    } else {
                        miro.requestAuthorization();
                    }
                }
            }
        },
        clientId: 'seu_client_id_aqui' // Substitua pelo seu Client ID do Miro
    });
});

async function createProprietaryBoard() {
    const board = await miro.board.get();
    
    // Criar frame principal
    const mainFrame = await miro.board.createFrame({
        title: data.title,
        width: 3000,
        height: 2000,
        x: 0,
        y: 0,
    });

    // Criar se√ß√µes de Hunting e Farming
    const huntingFrame = await createSection("Hunting - 1¬™ Quinzena", 0, 0, 1500, 1000, "#3498db", mainFrame.id);
    const farmingFrame = await createSection("Farming - 2¬™ Quinzena", 1500, 0, 1500, 1000, "#2ecc71", mainFrame.id);

    // Criar frames de semanas
    await createWeekFrames(huntingFrame.id, "Hunting");
    await createWeekFrames(farmingFrame.id, "Farming");

    // Adicionar se√ß√£o de m√©tricas
    await createMetricsSection(0, 1000, mainFrame.id);

    // Adicionar se√ß√£o de reflex√£o
    await createReflectionSection(1500, 1000, mainFrame.id);

    console.log("Board propriet√°rio criado com sucesso!");
}

async function createSection(title, x, y, width, height, color, parentId) {
    return await miro.board.createFrame({
        title: title,
        x: x,
        y: y,
        width: width,
        height: height,
        style: {
            fillColor: color,
        },
        parentId: parentId,
    });
}

async function createWeekFrames(parentId, type) {
    const weekWidth = 700;
    const weekHeight = 900;
    const week1 = await createSection(`${type} - Semana 1`, 25, 50, weekWidth, weekHeight, "transparent", parentId);
    const week2 = await createSection(`${type} - Semana 2`, 750, 50, weekWidth, weekHeight, "transparent", parentId);
    
    // Adicionar dias da semana e tarefas para cada semana
    await addWeekDays(week1.id, type, 1);
    await addWeekDays(week2.id, type, 2);
}

async function addWeekDays(weekFrameId, type, weekNumber) {
    const days = ["Segunda", "Ter√ßa", "Quarta", "Quinta", "Sexta"];
    const dayWidth = 130;
    let xOffset = 10;
    let yOffset = 30;

    for (const day of days) {
        await miro.board.createShape({
            content: `<p>${day}</p>`,
            x: xOffset,
            y: yOffset,
            width: dayWidth,
            height: 40,
            style: {
                textAlign: 'center',
                textAlignVertical: 'middle',
                fontSize: 14,
            },
            parentId: weekFrameId,
        });
        
        // Adicionar tarefas para o dia
        await addTasksForDay(weekFrameId, type, weekNumber, day, xOffset, yOffset + 50);
        
        xOffset += dayWidth + 10;
    }
}

async function addTasksForDay(weekFrameId, type, weekNumber, day, x, y) {
    const cycleIndex = type === "Hunting" ? 0 : 1;
    const weekIndex = weekNumber - 1;
    const dayActivities = data.cycles[cycleIndex].weeks[weekIndex].activities.find(act => act.day === day);
    
    if (dayActivities) {
        let yOffset = y;
        for (const task of dayActivities.tasks) {
            await miro.board.createCard({
                title: task.action,
                description: `${task.time}\nResultado: ${task.result}\nPr√≥xima a√ß√£o: ${task.nextAction}`,
                x: x,
                y: yOffset,
                style: {
                    backgroundColor: '#ffffff',
                },
                parentId: weekFrameId,
            });
            yOffset += 100; // Ajuste este valor conforme necess√°rio para o espa√ßamento entre tarefas
                }
    }
}

async function createMetricsSection(x, y, parentId) {
    const metricsFrame = await createSection("M√©tricas Mensais", x, y, 1500, 500, "#f39c12", parentId);
    let yOffset = 50;
    for (const metric of data.metrics) {
        await miro.board.createText({
            content: `<p>${metric.icon} ${metric.name}: ${metric.value}</p>`,
            x: 50,
            y: yOffset,
            style: { textAlign: 'left' },
            parentId: metricsFrame.id,
        });
        yOffset += 40;
    }
}

async function createReflectionSection(x, y, parentId) {
    const reflectionFrame = await createSection("Reflex√£o Mensal", x, y, 1500, 500, "#9b59b6", parentId);
    let yOffset = 50;
    for (const question of data.reflection.questions) {
        await miro.board.createText({
            content: `<p>${question}</p>`,
            x: 50,
            y: yOffset,
            style: { textAlign: 'left' },
            parentId: reflectionFrame.id,
        });
        yOffset += 40;
    }
}

// Renderiza a aplica√ß√£o web
renderApp();
